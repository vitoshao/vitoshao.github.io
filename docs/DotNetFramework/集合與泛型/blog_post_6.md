---
title: 集合類別
layout: default
parent: 集合與泛型
nav_order: 6
description: "集合類別"
date: 2012-01-16
tags: [DotNetFramework,集合與泛型]
postid: "6596102078177119959"
---
## 比較表

|  | Collection | Dictionary | Collection&lt;T&gt; | Dictionary&lt;T,U&gt; |
| --- | --- | --- | --- | --- |
| 基本型 | [ArrayList](http://msdn.microsoft.com/zh-tw/library/system.collections.arraylist) | [Hashtable](http://msdn.microsoft.com/zh-tw/library/system.collections.hashtable.aspx) | [List&lt;T&gt;](http://msdn.microsoft.com/zh-tw/library/6sh2ey19) | [Dictionary&lt;T,U&gt;](http://msdn.microsoft.com/zh-tw/library/xfhwa508) |
| 字串型別 | [StringCollection](http://msdn.microsoft.com/zh-tw/library/system.collections.specialized.stringcollection.aspx) | [StringDictionary](http://msdn.microsoft.com/zh-tw/library/system.collections.specialized.stringdictionary.aspx) ：1 key -&gt; 1 value  &lt;br&gt; [NameValueCollection](http://msdn.microsoft.com/zh-tw/library/system.collections.specialized.namevaluecollection.aspx) ：1 key -&gt; n value | [List&lt;T&gt;](http://msdn.microsoft.com/zh-tw/library/6sh2ey19) | [Dictionary&lt;T,U&gt;](http://msdn.microsoft.com/zh-tw/library/xfhwa508) |
| Bool型別 | [BitArray](http://msdn.microsoft.com/zh-tw/library/system.collections.bitarray.aspx) |  |  |  |
| 連續型的 | [Stack](http://msdn.microsoft.com/zh-tw/library/system.collections.stack.aspx) ：LIFO  &lt;br&gt; [Queue](http://msdn.microsoft.com/zh-tw/library/system.collections.queue.aspx) ：FIFO |  | [Stack&lt;T&gt;](http://msdn.microsoft.com/zh-tw/library/3278tedw)   &lt;br&gt; [Queue&lt;T&gt;](http://msdn.microsoft.com/zh-tw/library/7977ey2c) |  |
| item 順序 |  | [SortedList](http://msdn.microsoft.com/zh-tw/library/system.collections.sortedlist.aspx) ：順序依 key 值自動排序  &lt;br&gt;        [OrderedDictionary](http://msdn.microsoft.com/zh-tw/library/system.collections.specialized.ordereddictionary) ：順序維持加入的順序 |  | [SortedList&lt;T,U&gt;](http://msdn.microsoft.com/zh-tw/library/ms132319)   &lt;br&gt;       [SortedDictionaryt&lt;T,U&gt;](http://msdn.microsoft.com/zh-tw/library/f7fta44c.aspx)   &lt;br&gt;       [Dictionary&lt;T,U&gt;](http://msdn.microsoft.com/zh-tw/library/xfhwa508) |
| 存取效能 |  | [ListDictionary](http://msdn.microsoft.com/zh-tw/library/system.collections.specialized.listdictionary) ：適合項目小於 10 個的集合。  &lt;br&gt; [HybridDictionary](http://msdn.microsoft.com/zh-tw/library/system.collections.specialized.hybriddictionary) ：項目無法預期時，這個類別會自動調整。 |  | [Dictionary&lt;T,U&gt;](http://msdn.microsoft.com/zh-tw/library/xfhwa508) |

## 集合關係圖

| [System.Collections](http://msdn.microsoft.com/zh-tw/library/system.collections.aspx)&lt;br&gt;          &lt;ul id='TreeMenuView1' class='filetree treeview'&gt;              &lt;li&gt;&lt;a target="_blank" href="http://msdn.microsoft.com/zh-tw/library/system.collections.icomparer.aspx"&gt;&lt;span class='folder interface'&gt;IComparer&lt;/span&gt;&lt;/a&gt; &lt;/li&gt;              &lt;li&gt;&lt;a target="_blank" href="http://msdn.microsoft.com/zh-tw/library/system.collections.ienumerator.aspx"&gt;&lt;span class='folder interface'&gt;IEnumerator&lt;/span&gt;&lt;/a&gt; &lt;/li&gt;              &lt;li&gt;&lt;a target="_blank" href="http://msdn.microsoft.com/zh-tw/library/system.collections.ienumerable.aspx"&gt;&lt;span class='folder interface'&gt;IEnumerable&lt;/span&gt;&lt;/a&gt;                   &lt;ul&gt;                      &lt;li&gt;&lt;a target="_blank" href="http://msdn.microsoft.com/zh-tw/library/system.collections.icollection.aspx"&gt;&lt;span class='folder interface'&gt;ICollection&lt;/span&gt;&lt;/a&gt;                           &lt;ul&gt;                              &lt;li&gt;&lt;a target="_blank" href="http://msdn.microsoft.com/zh-tw/library/system.collections.idictionary.aspx"&gt;&lt;span class='folder interface'&gt;IDictionary&lt;/span&gt;&lt;/a&gt;                                   &lt;ul&gt;                                      &lt;li&gt;&lt;a target="_blank" href="http://msdn.microsoft.com/zh-tw/library/system.collections.hashtable.aspx"&gt;&lt;span class='file class'&gt;Hashtable&lt;/span&gt;&lt;/a&gt; &lt;/li&gt;                                      &lt;li&gt;&lt;a target="_blank" href="http://msdn.microsoft.com/zh-tw/library/system.collections.sortedlist.aspx"&gt;&lt;span class='file class'&gt;SortedList&lt;/span&gt;&lt;/a&gt; &lt;/li&gt;                                      &lt;li&gt;&lt;a target="_blank" href="http://msdn.microsoft.com/zh-tw/library/system.collections.specialized.listdictionary"&gt;&lt;span class='file class'&gt;ListDictionary (Specialized)&lt;/span&gt;&lt;/a&gt; &lt;/li&gt;                                      &lt;li&gt;&lt;a target="_blank" href="http://msdn.microsoft.com/zh-tw/library/system.collections.specialized.hybriddictionary"&gt;&lt;span class='file class'&gt;HybridDictionary (Specialized)&lt;/span&gt;&lt;/a&gt; &lt;/li&gt;                                      &lt;li&gt;&lt;a target="_blank" href="http://msdn.microsoft.com/zh-tw/library/system.collections.specialized.iordereddictionary.aspx"&gt;&lt;span class='folder interface'&gt;IOrderedDictionary&lt;/span&gt;&lt;/a&gt;                                           &lt;ul&gt;                                              &lt;li&gt;&lt;a target="_blank" href="http://msdn.microsoft.com/zh-tw/library/system.collections.specialized.ordereddictionary"&gt;&lt;span class='file class'&gt;OrderedDictionary (Specialized)&lt;/span&gt;&lt;/a&gt; &lt;/li&gt;                                          &lt;/ul&gt;                                     &lt;/li&gt;                                  &lt;/ul&gt;                              &lt;/li&gt;                              &lt;li&gt;&lt;a target="_blank" href="http://msdn.microsoft.com/zh-tw/library/system.collections.ilist.aspx"&gt;&lt;span class='folder interface'&gt;IList&lt;/span&gt;&lt;/a&gt;                                   &lt;ul&gt;                                      &lt;li&gt;&lt;a target="_blank" href="http://msdn.microsoft.com/zh-tw/library/system.collections.arraylist.aspx"&gt;&lt;span class='file class'&gt;ArrayList&lt;/span&gt;&lt;/a&gt; &lt;/li&gt;                                      &lt;li&gt;&lt;a target="_blank" href="http://msdn.microsoft.com/zh-tw/library/system.collections.specialized.stringcollection.aspx"&gt;&lt;span class='file class'&gt;StringCollection (Specialized)&lt;/span&gt;&lt;/a&gt; &lt;/li&gt;                                  &lt;/ul&gt;                              &lt;/li&gt;                              &lt;li&gt;&lt;a target="_blank" href="http://msdn.microsoft.com/zh-tw/library/system.collections.bitarray.aspx"&gt;&lt;span class='file class'&gt;BitArray&lt;/span&gt;&lt;/a&gt; &lt;/li&gt;                              &lt;li&gt;&lt;a target="_blank" href="http://msdn.microsoft.com/zh-tw/library/system.collections.queue.aspx"&gt;&lt;span class='file class'&gt;Queue&lt;/span&gt;&lt;/a&gt; &lt;/li&gt;                              &lt;li&gt;&lt;a target="_blank" href="http://msdn.microsoft.com/zh-tw/library/system.collections.stack.aspx"&gt;&lt;span class='file class'&gt;Stack&lt;/span&gt;&lt;/a&gt; &lt;/li&gt;                              &lt;li&gt;&lt;a target="_blank" href="http://msdn.microsoft.com/zh-tw/library/system.collections.specialized.namevaluecollection.aspx"&gt;&lt;span class='file class'&gt;NameValueCollection (Specialized)&lt;/span&gt;&lt;/a&gt; &lt;/li&gt;                           &lt;/ul&gt;                      &lt;/li&gt;                      &lt;li&gt;&lt;a target="_blank" href="http://msdn.microsoft.com/zh-tw/library/system.collections.specialized.stringdictionary.aspx"&gt;&lt;span class='file class'&gt;StringDictionary (Specialized)&lt;/span&gt;&lt;/a&gt; &lt;/li&gt;                  &lt;/ul&gt;              &lt;/li&gt;             &lt;/ul&gt; | [System.Collections.Generic](http://msdn.microsoft.com/zh-tw/library/system.collections.generic)&lt;br&gt;          &lt;ul id='TreeMenuView2' class='filetree treeview'&gt;              &lt;li&gt;&lt;a target='_blank' href='http://msdn.microsoft.com/zh-tw/library/8ehhxeaf'&gt;&lt;span class='folder interface'&gt;IComparer&lt;T&gt;&lt;/span&gt;&lt;/a&gt; &lt;/li&gt;              &lt;li&gt;&lt;a target='_blank' href='http://msdn.microsoft.com/zh-tw/library/78dfe2yb'&gt;&lt;span class='folder interface'&gt;IEnumerator&lt;T&gt;&lt;/span&gt;&lt;/a&gt; &lt;/li&gt;               &lt;li&gt;&lt;a target='_blank' href='http://msdn.microsoft.com/zh-tw/library/9eekhta0'&gt;&lt;span class='folder interface'&gt;IEnumerable&lt;T&gt;&lt;/span&gt;&lt;/a&gt;                   &lt;ul&gt;                      &lt;li&gt;&lt;a target='_blank' href='http://msdn.microsoft.com/zh-tw/library/8ehhxeaf'&gt;&lt;span class='folder interface'&gt;ICollection&lt;T&gt;&lt;/span&gt;&lt;/a&gt;                           &lt;ul&gt;                              &lt;li&gt;&lt;a target='_blank' href='http://msdn.microsoft.com/zh-tw/library/s4ys34ea'&gt;&lt;span class='folder interface'&gt;IDictionary&lt;T,U&gt;&lt;/span&gt;&lt;/a&gt;                                   &lt;ul&gt;                                      &lt;li&gt;&lt;a target='_blank' href='http://msdn.microsoft.com/zh-tw/library/xfhwa508'&gt;&lt;span class='file class'&gt;Dictionary&lt;T,U&gt;&lt;/span&gt;&lt;/a&gt; &lt;/li&gt;                                      &lt;li&gt;&lt;a target='_blank' href='http://msdn.microsoft.com/zh-tw/library/he2s3bh7'&gt;&lt;span class='file class'&gt;LinkedList&lt;T&gt;&lt;/span&gt;&lt;/a&gt; &lt;/li&gt;                                      &lt;li&gt;&lt;a target='_blank' href='http://msdn.microsoft.com/zh-tw/library/f7fta44c'&gt;&lt;span class='file class'&gt;SortedDictionary&lt;T,U&gt;&lt;/span&gt;&lt;/a&gt; &lt;/li&gt;                                  &lt;/ul&gt;                              &lt;/li&gt;                              &lt;li&gt;&lt;a target='_blank' href='http://msdn.microsoft.com/zh-tw/library/5y536ey6'&gt;&lt;span class='folder interface'&gt;IList&lt;T&gt;&lt;/span&gt;&lt;/a&gt;                                   &lt;ul&gt;                                      &lt;li&gt;&lt;a target='_blank' href='http://msdn.microsoft.com/zh-tw/library/6sh2ey19'&gt;&lt;span class='file class'&gt;List&lt;T&gt;&lt;/span&gt;&lt;/a&gt; &lt;/li&gt;                                  &lt;/ul&gt;                              &lt;/li&gt;                              &lt;li&gt;&lt;a target='_blank' href='http://msdn.microsoft.com/zh-tw/library/7977ey2c'&gt;&lt;span class='file class'&gt;Queue&lt;T&gt;&lt;/span&gt;&lt;/a&gt; &lt;/li&gt;                               &lt;li&gt;&lt;a target='_blank' href='http://msdn.microsoft.com/zh-tw/library/3278tedw'&gt;&lt;span class='file class'&gt;Stack&lt;T&gt;&lt;/span&gt;&lt;/a&gt; &lt;/li&gt;                          &lt;/ul&gt;                      &lt;/li&gt;                  &lt;/ul&gt;              &lt;/li&gt;          &lt;/ul&gt; |
| --- | --- |

## 集合與泛型集合對照表

| Type | Generic Type |
| --- | --- |
| [ArrayList](http://msdn.microsoft.com/zh-tw/library/system.collections.arraylist) | [List&lt;T&gt;](http://msdn.microsoft.com/zh-tw/library/6sh2ey19) |
| [StringCollection](http://msdn.microsoft.com/zh-tw/library/system.collections.specialized.stringcollection.aspx) |
| [Queue](http://msdn.microsoft.com/zh-tw/library/system.collections.queue.aspx) | [Queue&lt;T&gt;](http://msdn.microsoft.com/zh-tw/library/7977ey2c) |
| [Stack](http://msdn.microsoft.com/zh-tw/library/system.collections.stack.aspx) | [Stack&lt;T&gt;](http://msdn.microsoft.com/zh-tw/library/3278tedw) |
| [Hashtable](http://msdn.microsoft.com/zh-tw/library/system.collections.hashtable.aspx) | [Dictionary&lt;T,U&gt;](http://msdn.microsoft.com/zh-tw/library/xfhwa508) |
| [ListDictionary](http://msdn.microsoft.com/zh-tw/library/system.collections.specialized.listdictionary) |
| [HybridDictionary](http://msdn.microsoft.com/zh-tw/library/system.collections.specialized.hybriddictionary) |
| [OrderedDictionary](http://msdn.microsoft.com/zh-tw/library/system.collections.specialized.ordereddictionary) |
| [NameValueCollection](http://msdn.microsoft.com/zh-tw/library/system.collections.specialized.namevaluecollection.aspx) |
| [StringDictionary](http://msdn.microsoft.com/zh-tw/library/system.collections.specialized.stringdictionary.aspx) |
| [SortedList](http://msdn.microsoft.com/zh-tw/library/system.collections.sortedlist.aspx) | [SortedList&lt;T,U&gt;](http://msdn.microsoft.com/zh-tw/library/ms132319) |
|  | [SortedDictionary&lt;T,U&gt;](http://msdn.microsoft.com/zh-tw/library/f7fta44c.aspx) |
| [DictionaryEntry](http://msdn.microsoft.com/zh-tw/library/system.collections.dictionaryentry.aspx) | [KeyValuePair&lt;T,U&gt;](http://msdn.microsoft.com/zh-tw/library/5tbh8a42.aspx) |
| N/A | [LinkedList&lt;T&gt;](http://msdn.microsoft.com/zh-tw/library/he2s3bh7) |

## 以下三個型別的集合，都不會保留項目的順序，而且列舉集合時不保證以特定順序列出。

|  | [Hashtable](http://msdn.microsoft.com/zh-tw/library/system.collections.hashtable.aspx) | [StringDictionary](http://msdn.microsoft.com/zh-tw/library/system.collections.specialized.stringdictionary.aspx) | [NameValueCollection](http://msdn.microsoft.com/zh-tw/library/system.collections.specialized.namevaluecollection.aspx) |
| --- | --- | --- | --- |
| foreach | ```c#
Hashtable myCol = new Hashtable();<br><br>myCol.Add("111", "apple");<br>myCol.Add("333", "book");<br>myCol.Add("222", "cherry");<br>myCol.Add("444", "dog");<br>//myCol.Add("444", "egg");  disallow duplicate key<br><br>foreach (DictionaryEntry item in myCol)<br>{<br>    Console.WriteLine("{0} {1}", item.Key, item.Value);<br>}<br>//222 cherry<br>//444 dog<br>//111 apple<br>//333 book<br>``` | ```c#
StringDictionary myCol = new StringDictionary();<br><br>myCol.Add("111", "apple");<br>myCol.Add("333", "book");<br>myCol.Add("222", "cherry");<br>myCol.Add("444", "dog");<br>//myCol.Add("444", "egg");  disallow duplicate key<br><br>foreach (DictionaryEntry item in myCol)<br>{<br>    Console.WriteLine("{0} {1}", item.Key, item.Value);<br>}<br>//222 cherry<br>//444 dog<br>//111 apple<br>//333 book<br>``` | ```c#
NameValueCollection myCol = new NameValueCollection();<br><br>myCol.Add("111", "apple");<br>myCol.Add("333", "book");<br>myCol.Add("222", "cherry");<br>myCol.Add("444", "dog");<br>myCol.Add("444", "egg");<br><br>foreach (string key in myCol)<br>{<br>    Console.WriteLine("{0} {1}", key, myCol[key]);<br>}<br>//111 apple<br>//333 book<br>//222 cherry<br>//444 dog,egg<br>``` |
| IEnumerator | ```c#
IEnumerator myEnumerator = myCol.GetEnumerator();<br>DictionaryEntry de;<br>while (myEnumerator.MoveNext())<br>{<br>    de = (DictionaryEntry)myEnumerator.Current;<br>    Console.WriteLine("{0} {1}", de.Key, de.Value);<br>}<br>``` | ```c#
IEnumerator myEnumerator = myCol.GetEnumerator();<br>DictionaryEntry de;<br>while (myEnumerator.MoveNext())<br>{<br>    de = (DictionaryEntry)myEnumerator.Current;<br>    Console.WriteLine("{0} {1}", de.Key, de.Value);<br>}<br>``` | ```c#
IEnumerator myEnumerator = myCol.GetEnumerator();<br>DictionaryEntry de;<br>while (myEnumerator.MoveNext())<br>{<br>    de = (DictionaryEntry)myEnumerator.Current;<br>    Console.WriteLine("{0} {1}", de.Key, de.Value);<br>}<br>``` |
| foreach key | ```c#
foreach (var key in myCol.Keys)<br>{<br>    Console.WriteLine("{0}", key);<br>}<br><br>foreach (var value in myCol.Values)<br>{<br>    Console.WriteLine("{0}", value);<br>}<br>``` | ```c#
foreach (var key in myCol.Keys)<br>{<br>    Console.WriteLine("{0}", key);<br>}<br><br>foreach (var value in myCol.Values)<br>{<br>    Console.WriteLine("{0}", value);<br>}<br>``` | ```c#
//Print Keys And Values<br>foreach (string key in myCol.AllKeys)<br>{<br>    Console.WriteLine("{0} {1}", key, myCol[key]);<br>}<br>//111 apple<br>//333 book<br>//222 cherry<br>//444 dog,egg<br>``` |
| index | ```c#
不支援<br>``` | ```c#
不支援<br>``` | ```c#
for (int i = 0; i < myCol.Count; i++)<br>{<br>    // myCol[i] = myCol.Get(i) = myCol[myCol.GetKey(i)]<br><br>    Console.WriteLine("{0} {1}", myCol.GetKey(i), myCol[i]);<br>    Console.WriteLine("{0} {1}", myCol.GetKey(i), myCol.Get(i));<br>    Console.WriteLine("{0} {1}", myCol.GetKey(i), myCol[myCol.GetKey(i)]);<br>}<br>// 使用 myCol[i] , 回傳的是該項目的 value<br>//111 apple<br>//333 book<br>//222 cherry<br>//444 dog,egg<br>``` |