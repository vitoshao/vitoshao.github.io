---
title: 企業儲存架構--DAS、NAS、SAN、iSCD
layout: default
parent: 硬體設備
nav_order: 2
description: "企業儲存架構--DAS、NAS、SAN、iSCD"
date: 2013-10-08
tags: [MISC,硬體設備]
postid: "4531688274710951509"
---
企業在建構內部儲存網路時，通常會選擇DAS、NAS與SAN相互搭配以作為完整的解決方案，以下本文即分別就DAS、NAS與SAN進行逐一的介紹與分析比較。

# DAS (Direct Attached Storage:直接連接儲存設備)  

DAS是企業最早採行的On Line型儲存設備，使用一台Server，透過 SCSI 或 Fiber 裝置連接儲存裝置。其主要組成成分包括儲存裝置與作為介面的主機介面卡﹙Host Bus Adapter，HBA﹚。  

由於DAS是將儲存裝置直接與伺服器相連，因此這樣的設計能夠提供較高的安全性；但是在存取動作上就欠缺足夠的效率。  倘若企業內其他的伺服器想對與某一伺服器相連的儲存裝置進行存取動作，則資料傳送便必須經過區域網路﹙LAN﹚及該一伺服器，此舉不僅增加該伺服器的工作量，也會拖累該區域網路的傳輸速度。  在過去，企業大多採用DAS以從事儲存的任務，但是在企業資料量大幅增加的趨勢下，DAS逐漸地已經無法滿足企業對儲存工作的需求，因而有SAN及NAS的出現。  

#### DAS優點

1. 價格適中
2. 架構不複雜
3. 安全性高

#### DAS缺點

1. 擴充性差。
2. 另外當其他Server或PC要存取Storge時，必須經過該連接的Server。且使用檔案存取（File-Level）方式，資料存取速度，會受限於該台Server的I/O及所連接的SCSI效能。

#### DAS 網路架構

![](http://127.0.0.1:8080/_images/cs/misc-das.jpg)

# NAS (Network Attached Storage:網路附加儲存設備)  

NAS 將儲存系統透過一特殊專門的檔案伺服器直接連到區域網路上，而由於此一伺服器是專門設計用來進行資料存取的動作，因此企業內的其他伺服器便不須同時兼負資料存取的動作，而有更大空間去進行其他的工作。  

簡單講，NAS 就是一台客制化好的主機，整合一個大容量的儲存裝置，通常這種主機使用內嵌式系統(以Linux居多)，大部分都有提供Web介面操作。  

NAS尤其能夠為需要擷取與共享大量文件資料系統的企業環境，提供一個具有高度效率、性能／價格比優異的儲存解決方案，經常被應用在UNIX中的NFS﹙Network File System﹚或Windows NT的CIFS﹙Common Internet File System﹚中的文件共享工作。  原則上，NAS適合存放不需要運算的資料，例如電子郵件與檔案。  

而NAS的組成結構相當單純，僅有儲存裝置與一個檔案伺服器，簡而言之其對企業具有以下幾項重要的優點： 

1. 相對DAS而言，NAS架構下的儲存裝置不屬於某特定伺服器，使伺服器功能可獲得更好的發揮。
2. NAS使用TCP/IP協定，故在現有網路架構下即可運作，企業無須再建置新的儲存基礎建設，導入的複雜度亦較SAN低。
3. NAS已有標準協定，可以在不同的作業系統下運作，相容性高。
4. 尤其適用於長距離的小資料量傳輸工作。
5. 成本較SAN低。
6. 特別適合存放使用者眾多的資料：由於NAS採用TCP/IP協定，開放的網路架構，特別適合存放串流﹙Streaming﹚、影音(Video/Audio)或者CAD/CAM(電腦輔助設計/製造)..等類型的資料。

不過，由於NAS仍然是使用區域網路或廣域網路﹙WAN﹚來傳送資料，因此存取速度與資料分享程度都比不上SAN，尤其一些需要運算的資料亦不適合透過NAS來存取，為其主要的缺點。

#### 使用 NAS 和一般主機架設儲存設備的差異性

|  | NAS | 一般主機 |
| --- | --- | --- |
| 存取方式 | 透過網路儲存 | 透過網路儲存 |
| 管理方式 | 容易 | 較困難 |
| 管理界面 | WEB 界面 | 自行設定權限管理 |
| 效能 | 只有處理儲存 I/O 的方式,較不會對主機造成效能的負荷 | 主機處理儲存 I/O 的方式,還須負擔相關WINDOWS 的處理程序及服務,造成主機儲存的負荷 |
| 安全性 | 透過內建的帳號進行管,較不易中毒 | 採用 windows base 的認證方式,病毒防護性較差 |
| 網路協定 | 支援 TCP/IP , NETWARE, NFS,CFIS ,APPLETALK 協定 | 支援 TCP/IP , NETWARE, NFS,CFIS ,APPLETALK 協定 |
| 硬體架構 | 硬體可以透過前方的 LCD 面板來進行偵錯 | 須透過 MIS 人員 |

#### NAS 網路架構

![](http://127.0.0.1:8080/_images/cs/misc-nas.jpg)

# SAN (Storage Area Network:儲存區域網路)  

從上面的說明來看，NAS 就像一部可以提供大容量檔案系統的主機！  但是單部主機能夠提供的插槽再怎麼說也是有限的，所以並不能無限制的安插磁碟在同一部實體主機上面。  如果你就是有大量磁碟使用的需求，那時該如何是好？ 這時就得要使用到 SAN 這玩意兒啦！  

SAN 由其名稱即不難得知其概念即是將許多儲存裝置從區域網路獨立出來成為另一個網路，其最大的特色即在於得以實現伺服器與儲存設備間多對多的高速連接。  所以，它不是單一設備或是某種協定，它是一種服務架構，結合多種硬體(如：光纖、HBA卡、高速交換機、伺服器、磁碟陣列等)與軟體(管理軟體、initator與target軟體、驅動程式等)的技術。  

要注意喔，SAN 是提供『磁碟』 (block device)給主機用，而不是像 NAS 提供的是『網路協定的檔案系統』 (NFS, SMB...)！這兩者的差異挺大的喔！  因此，掛載使用 SAN 的主機會多出一個大磁碟，並可針對 SAN 提供的磁碟進行分割與格式化等動作。想想看，你能對 NAS 提供的檔案系統格式化嗎？不行吧！這樣瞭解差異否？  

SAN技術廣泛的運用在企業裡，用以提供高速的、可管理的、具容錯能力的、富彈性的儲存服務。譬如作為資料儲存、備份、系統備援等。

採用SAN的架構，可以將各個單一的儲存設備連結起來，提供整合性的管理與應用。SAN最大的用途不僅在於做為資料的儲存，而是在於其容錯與災難備援的能力。這也是企業採用SAN的主要原因，一方面可以將所有的儲存資源妥善的管理，另一方面可以提供不中斷的營運服務，在遇到天災(水火意外)、人禍(電腦病毒)時，可以在最短的時間內，最有效的復原，從而避免損失。

現階段技術比較成熟的SAN，仍必須透過光纖通道﹙Fibre Channel﹚與伺服主機做連結，因此所有的設備必須支援光纖。  目前的傳輸速率一般為100MB／Sec，但最快可達200MB／Sec。  企業要建構SAN，則必須要在伺服主機內部安裝光纖介面卡，在主機外則必須裝設光纖纜線、光纖介面的集線器﹙Hub﹚、交換器﹙Switch﹚與路由器﹙Router﹚…等裝置，如此各伺服器才能透過光纖通道與SAN進行連結。  

#### SAN 優點

SAN的主要構成成分包括有儲存裝置、SAN集線器或交換器、路由器….等，其架構與組成具有相當大的彈性。一般大致說來，SAN的優點有以下幾點：

1. 連接性佳：  
在SAN架構下，任一伺服器可與任一儲存裝置直接相連，任一儲存裝置也可彼此直接相連。
2. 擴充性佳：  
企業可以在不增加伺服器與區域網路負擔的情況下進行擴充的動作。
3. 管理效能佳：  
可以輕易地對分散各處的儲存裝置進行管理。
4. 資料分享能力優異：  
因儲存裝置不再與特定的某一伺服器相連，故可由許多伺服器共享資源，並且大量檔案傳輸亦不會影響主網路效能。
5. LAN-Free與Serverless的資料備份能力：  
因為儲存裝置間彼此直接相連，使備份工作無須佔據伺服器空間與區域網路的頻寬，具備快速備份與災難復原能力。
6. 特別適合存放需要運算的資料：  
由於SAN具備高效率的傳輸速度，因此特別適合存放運算工作量大的資料。

#### SAN 缺點

不過，SAN亦具有以下的一些缺點：

1. 成本較高、且建置費時︰  
由於企業導入SAN架構，除了添購儲存設備之外，更必須建置先光纖基礎建設、並購置光纖交換器或集線器，因此非但整體持有成本較NAS為高，建置工程亦較為繁複。
2. 仍無共同標準可供業界遵循：  
因為目前SAN架構並沒有一個共同的標準可供廠商遵循，故現階段的SAN產品僅能夠在某些作業系統與產品間進行跨平台的運作，因此SAN廠商便必須花費可觀的心力來整合許多組成要素以建構SAN的解決方案。

#### SAN 網路架構

![](http://127.0.0.1:8080/_images/cs/misc-SAN.gif)

#### SAN 的拓墣

SAN的拓墣主要可分為︰點對點（point-to-point）、環狀（Fibre Channel Arbitrated Loop，FC-AL：）與網狀（fabric）等三種形式︰

- 點對點拓墣  
目前點對點拓墣仍是SAN最常見的拓墣型態，在此一拓墣形式下，伺服器乃是直接與儲存裝置相連結，最大的優點是不會有其它裝置的干擾，但是因為連結性不佳，故隨著SAN的技術發展與企業需求的演進，此類拓墣的比重將可望逐漸下降。
- FC-AL拓墣  
若就實體架構來看，因為有一集線器位於SAN的中心，促使FC-AL拓墣看起來像是星型拓墣，但是就邏輯上而言，FC-AL卻為一環狀拓墣，最高可連結126個節點。
- Fabric拓墣  
Fabric拓墣中以一個交換器擔任SAN的中心樞紐，儲存架構中的任何一節點只要與該交換器相連，便能夠和其他所有的節點相通，因此形成一個網狀的拓墣。

就SAN所針對的大型企業市場而言，企業為提高資料的容錯性、安全性及傳輸效率等， Fabric拓墣勢必將可望成為SAN結構的主流。根據Dataquest在2000年8月發表的調查報告即指出，Fibre Channel SAN的各項元件，包括HBA、 Switch、Director、Router與Hub…等產品在1999年的市場規模僅約為5.1億美元，但是預計在2003年市場規模將可達到54.7億美元的規模，年複合成長率高達81%，除了成長幅度相當驚人之外，其中交換器的市場比重更由26%大幅提昇至45%，1999至2003年的年複合成長率更以99%遠超過集線器的23%，由此即不難推敲出Fabric拓墣將成為SAN主流的趨勢。

# iSCSI (Internet SCSI)

iSCSI又稱IP-SAN，是一種基於網際網路及SCSI-3協議下的存儲技術。它融合了SAN的高擴充性及，以及NAS的便利性。

它使用網路線當傳輸媒介，不需要像SAN一樣使用光纖設備。它的架構跟NAS一樣，因此不影響現有網路架構，相對的價格上便宜許多。

另外，它是使用IP的方式，將SCSI協定包在封包裡面，讓支援iSCSI的設備彼此做資料交換。因此它可以做到SCSI的區塊存取特性，讓Storage分配區塊給有支援iSCSI的Server，視為本機的硬碟，作為資料庫、Mail、File的直接儲存空間。

PC端若支援iSCSI，也可以直接存取iSCSI Storage。目前Win7已支援iSCSI協定。

也就是說，iSCSI 這個架構主要將儲存裝置與使用的主機分為兩個部分，分別是：

- iSCSI target：就是儲存設備端，存放磁碟或 RAID 的設備，目前也能夠將 Linux 主機模擬成 iSCSI target 了！目的在提供其他主機使用的『磁碟』。
- iSCSI initiator：就是能夠使用 target 的用戶端，通常是伺服器。 也就是說，想要連接到 iSCSI target 的伺服器，也必須要安裝 iSCSI initiator 的相關功能後才能夠使用 iSCSI target 提供的磁碟。

![](http://127.0.0.1:8080/_images/cs/misc-iSCSI.gif)

#### iSCSI的優點

價格適中，架構簡單，擴充性強，支援區塊存取。

#### iSCSI的缺點

設備需支援iSCSI協定，操作需學習。

# SAN+NAS+IP 整合解決方案 (SAN+NAS+IP Consolidation)

NAS與SAN的應用是不同的。前者主要是檔案分享 ( file sharing )，後者則為硬碟空間的分享 ( block sharing )。在IT領域，SAN極適合作為資料庫系統、mail等application server的應用，NAS則主要為檔案系統 ( NT/CIFS，UNIX/NFS ) 分享；此二種應用型態是IT部門不可或缺的。

由飛康公司 ( FalconStor ) 推出的SAN/NAS gateway：IPStor即是最佳的SAN與NAS完全整合方案。IPStor server將所控管的所有storage虛擬化，當切割LUN時，管理者可設定其為SAN或NAS。SAN LUN可指定給SAN attached主機使用，NAS LUN則經由網路共享。

IPStor的解決方案真正整合了SAN與NAS：

1. SAN與NAS的LUN由同一介面與操作模式控管
2. SAN與NAS的virtualization應用完全相同
3. SAN與NAS應用共享所有的硬碟空間

# NAS與SAN之比較 

因為NAS與SAN的適用環境有所不同，再加上企業對於成本與實際運作需要的考量不一，因此許多企業經常都同時擁有NAS與SAN這兩種儲存架構。事實上，NAS與SAN架構在目前的在儲存設備市場上，呈現一種互補、卻又相互競爭的特殊狀況。  

由於架構與應用技術上的差異，促使NAS與SAN各自有其適用的情況。例如NAS採用的是技術較成熟、且成本低廉的區域網路，但是因為其穩定性不如光纖通道，因此較適合使用於網路目錄服務與檔案服務…等應用程式；至於SAN因為是在專屬的儲存架構上運作，因此諸如主從運算架構應用程式、資料庫…等專屬性或是績效要求高的應用工作，便適合透過SAN的架構才加以實現。  

DAS原則上仍會是現階段企業儲存架構中必然出現的選擇，但是未來NAS將會挾成本與建置效率的優勢、陸續搶攻中小企業的儲存市場，而SAN則會因為傳輸效率佳而受到大型跨國企業的青睞。  

由於NAS與SAN各自支援不同儲存需求的解決方案，兩者具有高度的互補性，最常見的情況之一便是企業運用NAS負責供應靜態網頁，而藉由SAN提供動態資料庫與交易記錄等方面的儲存，過去這兩種不同型態的資料類型的內容重複性甚高，經常被分別儲存在SAN與NAS上，往往造成儲存資源的浪費，目前已經有不少業者積極提出整合兩者的儲存解決方案，將兩者的儲存資源進行整合，尋求建構更具運作效率、且總體持有成本更低廉的企業儲存解決方案，目前市面上已有部分不錯的儲存產品或是解決方案推出。

# 各元件相關性

綜合以上說明，一部伺服器要如何取得磁碟或者是檔案系統呢？基本上就是：

- 直接存取 (DAS)：例如本機上面的磁碟，就是直接存取設備。
- 透過儲存區域網路 (SAN)：來自區網內的其他儲存設備提供的磁碟。
- 網路檔案系統 (NAS)：來自 NAS 提供的檔案系統，只能立即使用，不可進行格式化。
- 

這三個東西與伺服器主機能用的檔案系統之間可以用維基百科的圖示來展示：

![](http://127.0.0.1:8080/_images/cs/misc-das_nas_san.gif)

從上圖中，我們可以發現在一般的主機環境下，磁碟裝置 (SATA, SAS, FC) 可以透過主機的介面 (DAS) 來直接進行檔案系統的建立 (mkfs 進行格式化)，如果想要使用外部的磁碟，那可以透過 SAN (內含多個磁碟的設備)，然後透過 iSCSI 等介面來連線， 當然，還是得要進行格式化等動作 (假設這個 SAN 尚未被使用時)。最後，如果是 NAS 的條件下，那麼 NAS 必須要先透過自己的作業系統將磁碟裝置進行檔案系統的建立後，再以 NFS/CIFS 等方式來提供其他主機掛載使用。

接下來，網路伺服器、用戶端系統、NAS 與 SAN 的角色在區網裡面又是如何呢？我們依舊使用維基百科的圖示來說明一下 (DAS 是每部主機內部的磁碟，即底下圖示中的圓柱體)：

![](http://127.0.0.1:8080/_images/cs/misc-das_nas_san-2.gif)

NAS 可以使用自己的磁碟，也能夠透過光纖或乙太網路取得 SAN 所提供的磁碟來製作成為網路檔案系統，提供其他人的使用。 Server 可以透過 NFS/CIFS 等方式取得 NAS 的檔案系統，當然也能夠直接存取 SAN 的磁碟。用戶端主要則是透過網路檔案系統， 並且直接使用 Server 提供的網路資源 (如 FTP, WWW, mail 等等)。
## 參考資料  
![](http://127.0.0.1:8080/_images/cs/ReferencePage.png)

- [企業儲存架構--DAS、NAS與SAN簡介(一)](http://www2.yvtc.gov.tw/training/net/%E7%B6%B2%E8%B7%AF%E8%A6%8F%E5%8A%83%E4%BD%9C%E6%A5%AD/%E7%95%B0%E5%9C%B0%E5%82%99%E6%8F%B4/DAS%20&%20NAS%20&%20SAN%281%29.htm)
- [儲存技術ABC 之 初談SAN(Storage Area Network)](http://ithelp.ithome.com.tw/question/10008219)
- [鳥哥的 Linux 私房菜：第十八章、網路磁碟裝置： iSCSI 伺服器](http://linux.vbird.org/linux_server/0460iscsi.php)